- name: create subnets
  os_subnet:
    state: present
    cloud: "{{ cloud }}"
    network_name: "{{ item.key }}"
    name: "{{ item.key}}_subnet"
    cidr: "{{ item.value.cidr }}"
    dns_nameservers: 
      - "{{ item.value.dns.dns1 }}"
      - "{{ item.value.dns.dns2 }}"
    host_routes:
      - destination: "{{ item.value.route.dest }}"
        nexthop: "{{ item.value.route.next }}"
  with_dict: "{{ networks }}"
