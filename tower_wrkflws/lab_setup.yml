---
  - hosts: localhost
    connection: local
    become: true
  
    tasks:
      - name: create temp dir
        file:
          path: ./temp
          state: directory
  
  - hosts: bastion
    become: true
          
    tasks:
     - name: fetch key file 
       fetch:
         src: "/root/.ssh/{{ GUID }}key.pem"
         dest: ./temp
   
  - hosts: localhost
    connection: local
    become: true
    
    tasks:
      - name: move pem file to .ssh dir
        copy: 
          src: "./temp/bastion/root/.ssh/{{ GUID }}key.pem"
          dest: /home/trentm/.ssh/
          owner: trentm
          mode: 0400

      - name: remove temp dir
        file:
          path: ./temp
          state: absent
